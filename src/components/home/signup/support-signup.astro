---
import { When } from '@astropub/flow'
import './home-signup.css'

const currentPathname = Astro.url.pathname
const supportPath = (currentPathname === '/support/')

console.log("test")
---

<style>

/* Chrome, Safari, Edge */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
    -webkit-appearance: none;
     margin: 0;
}
/* Firefox */
    input[type=number] {
    -moz-appearance: textfield;
}

#mc-embedded-subscribe {
    
	/* Appearance */
	background-color: var(--InteractiveHoverColor);
    
    /* Layout */
	margin-inline: auto !important;
	margin-block-start: 4--step;
	padding-block: 2--step;
	padding-inline: 11--step;

	/* Text */
	font-size: 16--rpx;
	line-height: max(20 / 16);

	/* Appearance */
	background-color: var(--InteractiveColor);
	border-radius: 3--rpx;
	box-shadow: var(--InteractiveColor) 0 0 0 1px inset;
	color: var(--InverseColor);
	cursor: pointer;
    border: none !important;
}

#mc_embed_signup form {

    /* Layout */
    margin-top: 5--step;
    display: flex;
    flex-flow: column;
    padding-block: max(5 * var(--step)) max(10 * var(--step));
    padding-inline: max(6 * var(--step));
    max-width: 125--step;

    /* Text */
    font-size: max(4 * var(--step));
    font-weight: 400;
    letter-spacing: .5%;

    /* Appearance */
    background: var(--SurfaceColor);
    border-radius: max(3 * var(--rpx));
    color: var(--PrimaryColor);
}

#mc_embed_signup .mc-field-group input {

    /* Layout */
    padding-block: max(3 * var(--step));
    padding-inline-start: max(4 * var(--step));

    /* Appearance */
    background: var(--BaseColor);
    border-radius: max(3 * var(--rpx));
    border: none;
}

</style>


<When {supportPath}>
<section id="email-signup" class="support__email-signup" class="p-signup">
    <!-- Begin Mailchimp Signup Form -->
    <link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">

    <div id="mc_embed_signup">
        <form action="https://rocketcom.us12.list-manage.com/subscribe/post?u=f067e558ee805172850a87843&amp;id=c1af406c10" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="novalidate">
            <div id="mc_embed_signup_scroll">
                <!-- <h2><strong>Sign up</strong> to get notified when Astro is updated</h2> -->
                <!-- <div class="indicates-required"><span class="asterisk">*</span> indicates required</div> -->
                <div class="mc-field-layout">
                    <div class="mc-field-group">
                        <label for="mce-FNAME">First Name <span class="asterisk">*</span>
                        </label>
                        <input type="text" value="" name="FNAME" class="required firstName" id="mce-FNAME" aria-required="true" placeholder="Enter First Name" onkeyup= "handleSubmit()"> 
                    </div>
                    <div class="mc-field-group">
                        <label for="mce-LNAME">Last Name <span class="asterisk">*</span>
                        </label>
                        <input type="text" value="" name="LNAME" class="required lastName" id="mce-LNAME" aria-required="true" placeholder="Enter Last Name" onkeyup= "handleSubmit()">
                    </div>
                    <div class="mc-field-group">
                        <label for="mce-EMAIL">Email Address <span class="asterisk">*</span>
                        </label>
                        <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" aria-required="true" placeholder="Enter Email Address" onkeyup= "handleSubmit()">
                    </div>
                    <div class="mc-field-group">
                        <label for="mce-PHONE">Phone Number <span class="asterisk">*</span>
                        </label>
                        <input type="number" value="" name="PHONE" class="required phone" id="mce-PHONE" aria-required="true" placeholder="Enter Phone Number (123-456-7890)" onkeyup= "handleSubmit()">
                    </div>
                    <div class="mc-field-group">
                        <label for="mce-COMPANY">Company Name
                        </label>
                        <input type="text" value="" name="COMPANY" class="" id="mce-COMPANY" placeholder="Enter Company Name" onkeyup= "handleSubmit()">
                    </div>
                    <div class="mc-field-group">
                        <label for="mce-EMAIL">Title/Position
                        </label>
                        <input type="text" value="" name="TITLE" class="" id="mce-TITLE" placeholder="Enter Title / Position" onkeyup= "handleSubmit()" >
                    </div>
                </div>
                <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none">
						</div>
                        <div class="response" id="mce-success-response" style="display:none">
                    </div>
                </div>
                <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_f067e558ee805172850a87843_c1af406c10" tabindex="-1" value="">
				</div>

                <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="primary">
                </div>
			</div>
        </form>
    </div>

	<script>
		function handleSubmit() {

		const form = document.form['mc-embedded-subscribe-form'].elements
        const allowSubmit = true

		for (var i = 0; i < f.length; i++) {
            if (form[i].value.length == 0) allowSubmit = false;
        }
		if (allowSubmit) {
			document.getElementById('mc-embedded-subscribe').disabled = false;
		} else {
			document.getElementById('mc-embedded-subscribe').disabled = 'disabled'
		 }	
		}
	</script>

    <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script>
    <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script>
    <script type="text/javascript">
        (function ($) {
            window.fnames = new Array();
            window.ftypes = new Array();
            fnames[0] = 'FNAME';
            ftypes[0] = 'text';
            fnames[1] = 'LNAME';
            ftypes[1] = 'text';
            fnames[2] = 'EMAIL';
            ftypes[2] = 'email';
            fnames[3] = 'PHONE';
            ftypes[3] = 'number';
            fnames[4] = 'COMPANY';
            ftypes[4] = 'text';
            fnames[5] = 'TITLE';
            ftypes[5] = 'text';
        }(jQuery));
        var $mcj = jQuery.noConflict(true);
    </script>
</section>
</When>
